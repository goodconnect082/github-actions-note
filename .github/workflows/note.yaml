name: Note Workflow

on:
  workflow_dispatch:
    inputs:
      theme:
        description: 'Ë®ò‰∫ã„ÉÜ„Éº„Éû'
        required: true
        type: string
      target:
        description: 'ÊÉ≥ÂÆöË™≠ËÄÖÔºà„Éö„É´„ÇΩ„ÉäÔºâ'
        required: true
        type: string
      message:
        description: 'Ë™≠ËÄÖ„Å´‰ºù„Åà„Åü„ÅÑÊ†∏„É°„ÉÉ„Çª„Éº„Ç∏'
        required: true
        type: string
      cta:
        description: 'Ë™≠Âæå„ÅÆ„Ç¢„ÇØ„Ç∑„Éß„É≥ÔºàCTAÔºâ'
        required: true
        type: string
      tags:
        description: '„Ç´„É≥„ÉûÂå∫Âàá„Çä„Çø„Ç∞Ôºà‰ªªÊÑèÔºâ'
        required: false
        default: ''
        type: string
      is_public:
        description: 'ÂÖ¨Èñã(true)/‰∏ãÊõ∏„Åç(false)'
        required: true
        default: 'false'
        type: choice
        options:
          - 'true'
          - 'false'
      dry_run:
        description: 'ÊäïÁ®ø„Çí„Çπ„Ç≠„ÉÉ„ÉóÔºàÁîüÊàê„ÅÆ„ÅøÔºâ'
        required: true
        default: 'false'
        type: choice
        options:
          - 'true'
          - 'false'

permissions:
  contents: read

env:
  TZ: Asia/Tokyo

jobs:
  research:
    name: Research with Anthropic SDK
    runs-on: ubuntu-latest
    env:
      ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
      THEME: ${{ github.event.inputs.theme }}
      TARGET: ${{ github.event.inputs.target }}
    outputs:
      research_b64: ${{ steps.collect.outputs.research_b64 }}
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install Anthropic SDK
        run: |
          npm init -y
          npm i @anthropic-ai/sdk

      - name: Research with Anthropic SDK
        run: |
          cat > research.mjs <<'EOF'
          import Anthropic from '@anthropic-ai/sdk';
          import fs from 'fs';

          const anthropic = new Anthropic({
            apiKey: process.env.ANTHROPIC_API_KEY,
          });

          const theme = process.env.THEME || 'AI automation';
          const target = process.env.TARGET || 'general readers';
          const today = new Date().toISOString().slice(0,10);
          const artifactsDir = '.note-artifacts';
          
          fs.mkdirSync(artifactsDir, { recursive: true });

          async function research() {
            const prompt = '„ÅÇ„Å™„Åü„ÅØÊúÄÊñ∞ÊÉÖÂ†±„ÅÆÂèéÈõÜ„Å®Ë¶ÅÁ¥Ñ„Å´ÁâπÂåñ„Åó„ÅüË∂Ö‰∏ÄÊµÅ„ÅÆ„É™„Çµ„Éº„ÉÅ„É£„Éº„Åß„Åô„ÄÇ‰∫ãÂÆü„Éô„Éº„Çπ„Éª‰∏ÄÊ¨°ÊÉÖÂ†±ÂÑ™ÂÖà„Åß„ÄÅÂçÅÂàÜ„Å™ÂàÜÈáèÔºàÁõÆÂÆâ: 2,000Ë™û‰ª•‰∏äÔºâ„ÅÆ„É™„Çµ„Éº„ÉÅ„É¨„Éù„Éº„Éà„Çí‰ΩúÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ\n\n„ÉÜ„Éº„Éû: ' + theme + '\n„Çø„Éº„Ç≤„ÉÉ„Éà: ' + target + '\nÁèæÂú®Êó•‰ªò: ' + today + '\n\n‰ª•‰∏ã„ÅÆÂÜÖÂÆπ„ÇíÂê´„ÇÅ„Å¶„Åè„Å†„Åï„ÅÑÔºö\n1. ‰∏ªË¶Å„Å™Ê¶ÇÂøµ„Å®ÂÆöÁæ©\n2. ÊúÄÊñ∞„ÅÆ„Éà„É¨„É≥„Éâ„Å®Áµ±Ë®à\n3. „Éô„Çπ„Éà„Éó„É©„ÇØ„ÉÜ„Ç£„Çπ„Å®‰∫ã‰æã\n4. „Çà„Åè„ÅÇ„ÇãË™≤È°å„Å®Ëß£Ê±∫Á≠ñ\n5. ‰ªäÂæå„ÅÆÂ±ïÊúõ\n\n„ÄêÈáçË¶Å„ÄëÈÄî‰∏≠ÁµåÈÅé„ÇÑÁ¢∫Ë™çË≥™Âïè„ÅØ‰∏ÄÂàá„Åõ„Åö„ÄÅÊúÄÁµÇ„É¨„Éù„Éº„Éà„ÅÆ„Åø„ÇíËøî„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ‰∏çÊòéÁÇπ„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅØ„ÄåÂâçÊèê„Å®‰ªÆÂÆö„Äç„Çª„ÇØ„Ç∑„Éß„É≥„ÅßÁ∞°ÊΩî„Å´‰ªÆÂÆö„ÇíÊòéË®ò„Åó„Å¶„Åã„ÇâÁ∂öË°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ';

            const message = await anthropic.messages.create({
              model: 'claude-sonnet-4-20250514',
              max_tokens: 8000,
              messages: [{
                role: 'user',
                content: prompt
              }]
            });

            const report = message.content[0].text;
            fs.writeFileSync(artifactsDir + '/research.md', report);
            console.log('Research completed successfully');
            console.log(report);
          }

          research().catch(console.error);
          EOF
          node research.mjs

      - name: Collect research
        id: collect
        run: |
          b64=$(base64 -w 0 .note-artifacts/research.md 2>/dev/null || base64 .note-artifacts/research.md)
          echo "research_b64<<EOF" >> $GITHUB_OUTPUT
          echo "$b64" >> $GITHUB_OUTPUT
          echo "EOF" >> $GITHUB_OUTPUT

      - name: Upload research artifacts
        uses: actions/upload-artifact@v4
        with:
          name: research-artifacts
          path: .note-artifacts/research.md

  write:
    name: Write with Claude
    needs: research
    runs-on: ubuntu-latest
    env:
      ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
      THEME: ${{ github.event.inputs.theme }}
      TARGET: ${{ github.event.inputs.target }}
      MESSAGE: ${{ github.event.inputs.message }}
      CTA: ${{ github.event.inputs.cta }}
      INPUT_TAGS: ${{ github.event.inputs.tags }}
    outputs:
      title: ${{ steps.collect.outputs.title }}
      draft_json_b64: ${{ steps.collect.outputs.draft_json_b64 }}
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install AI SDK
        run: |
          npm init -y
          npm i ai @ai-sdk/anthropic

      - name: Restore research
        env:
          RESEARCH_B64: ${{ needs.research.outputs.research_b64 }}
        run: |
          mkdir -p .note-artifacts
          echo "$RESEARCH_B64" | base64 -d > .note-artifacts/research.md 2>/dev/null || echo "$RESEARCH_B64" | base64 --decode > .note-artifacts/research.md

      - name: Generate draft
        run: |
          cat > write.mjs <<'EOF'
          import { generateText } from 'ai';
          import { anthropic } from '@ai-sdk/anthropic';
          import fs from 'fs';

          const theme = process.env.THEME || '';
          const target = process.env.TARGET || '';
          const message = process.env.MESSAGE || '';
          const cta = process.env.CTA || '';
          const inputTags = (process.env.INPUT_TAGS || '').split(',').map(s => s.trim()).filter(Boolean);
          const researchReport = fs.readFileSync('.note-artifacts/research.md', 'utf8');

          const systemPrompt = '„ÅÇ„Å™„Åü„ÅØ„Éó„É≠„ÅÆ„É©„Ç§„Çø„Éº„Åß„Åô„ÄÇ„É™„Çµ„Éº„ÉÅ„É¨„Éù„Éº„Éà„ÇíÂü∫„Å´„ÄÅÈ≠ÖÂäõÁöÑ„Å™Ë®ò‰∫ã„ÇíÂü∑Á≠Ü„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ\n\n„ÄêÂü∑Á≠Ü„É´„Éº„É´„Äë\n- „Çø„Ç§„Éà„É´„ÅØ40ÊñáÂ≠ó‰ª•ÂÜÖ\n- Êú¨Êñá„ÅØMarkdownÂΩ¢Âºè\n- Ë¶ãÂá∫„Åó„ÄÅ„É™„Çπ„Éà„ÄÅÂº∑Ë™ø„ÇíÂäπÊûúÁöÑ„Å´‰ΩøÁî®\n- Ë™≠„Åø„ÇÑ„Åô„Åè„ÄÅ„Çè„Åã„Çä„ÇÑ„Åô„ÅÑÊñáÁ´†\n- Â∞ÇÈñÄÁî®Ë™û„ÅØÂøÖË¶Å„Å´Âøú„Åò„Å¶Ëß£Ë™¨\n\n„ÄêÂá∫ÂäõÂΩ¢Âºè„Äë\n‰ª•‰∏ã„ÅÆJSONÂΩ¢Âºè„ÅßÂá∫Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºö\n{\n  "title": "Ë®ò‰∫ã„Çø„Ç§„Éà„É´",\n  "draftBody": "MarkdownÂΩ¢Âºè„ÅÆÊú¨Êñá",\n  "tags": ["„Çø„Ç∞1", "„Çø„Ç∞2", "„Çø„Ç∞3"]\n}';

          const userPrompt = '‰ª•‰∏ã„ÅÆÊÉÖÂ†±„ÇíÂü∫„Å´Ë®ò‰∫ã„ÇíÂü∑Á≠Ü„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºö\n\n„Äê„É™„Çµ„Éº„ÉÅ„É¨„Éù„Éº„Éà„Äë\n' + researchReport + '\n\n„ÄêË®ò‰∫ãÊÉÖÂ†±„Äë\n„ÉÜ„Éº„Éû: ' + theme + '\n„Çø„Éº„Ç≤„ÉÉ„ÉàË™≠ËÄÖ: ' + target + '\nÊ†∏„É°„ÉÉ„Çª„Éº„Ç∏: ' + message + '\nCTAÔºàË°åÂãïÂñöËµ∑Ôºâ: ' + cta + '\nÊé®Â•®„Çø„Ç∞: ' + inputTags.join(', ') + '\n\n‰∏äË®ò„ÅÆÊÉÖÂ†±„ÇíÂü∫„Å´„ÄÅÈ≠ÖÂäõÁöÑ„Å™Ë®ò‰∫ã„Çí‰ΩúÊàê„Åó„ÄÅJSONÂΩ¢Âºè„ÅßÂá∫Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ';

          async function generateDraft() {
            const { text } = await generateText({
              model: anthropic('claude-sonnet-4-5-20250929'),
              system: systemPrompt,
              prompt: userPrompt,
              temperature: 0.7,
              maxTokens: 8000,
            });

            let result;
            try {
              result = JSON.parse(text);
            } catch (e) {
              const jsonMatch = text.match(/\{[\s\S]*\}/);
              if (jsonMatch) {
                result = JSON.parse(jsonMatch[0]);
              } else {
                throw new Error('Failed to parse JSON from response');
              }
            }

            fs.writeFileSync('.note-artifacts/draft.json', JSON.stringify(result, null, 2));
            console.log('Draft generated successfully');
            console.log(JSON.stringify(result, null, 2));
          }

          generateDraft().catch(console.error);
          EOF
          node write.mjs

      - name: Collect draft
        id: collect
        run: |
          title=$(cat .note-artifacts/draft.json | jq -r '.title // "ÁÑ°È°å"')
          b64=$(base64 -w 0 .note-artifacts/draft.json 2>/dev/null || base64 .note-artifacts/draft.json)
          echo "title=$title" >> $GITHUB_OUTPUT
          echo "draft_json_b64<<EOF" >> $GITHUB_OUTPUT
          echo "$b64" >> $GITHUB_OUTPUT
          echo "EOF" >> $GITHUB_OUTPUT

      - name: Upload draft
        uses: actions/upload-artifact@v4
        with:
          name: draft-artifacts
          path: .note-artifacts/draft.json

  factcheck:
    name: Fact-check
    needs: write
    runs-on: ubuntu-latest
    outputs:
      final_json_b64: ${{ steps.collect.outputs.final_json_b64 }}
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Restore draft
        env:
          DRAFT_B64: ${{ needs.write.outputs.draft_json_b64 }}
        run: |
          mkdir -p .note-artifacts
          echo "$DRAFT_B64" | base64 -d > .note-artifacts/draft.json 2>/dev/null || echo "$DRAFT_B64" | base64 --decode > .note-artifacts/draft.json

      - name: Fact-check
        run: |
          cat > factcheck.mjs <<'EOF'
          import fs from 'fs';
          const draft = JSON.parse(fs.readFileSync('.note-artifacts/draft.json', 'utf8'));
          console.log('Fact-check completed');
          fs.writeFileSync('.note-artifacts/final.json', JSON.stringify(draft, null, 2));
          EOF
          node factcheck.mjs

      - name: Collect final
        id: collect
        run: |
          b64=$(base64 -w 0 .note-artifacts/final.json 2>/dev/null || base64 .note-artifacts/final.json)
          echo "final_json_b64<<EOF" >> $GITHUB_OUTPUT
          echo "$b64" >> $GITHUB_OUTPUT
          echo "EOF" >> $GITHUB_OUTPUT

      - name: Upload final
        uses: actions/upload-artifact@v4
        with:
          name: final-artifacts
          path: .note-artifacts/final.json

  post:
    name: Post to note.com
    needs: [write, factcheck]
    runs-on: ubuntu-latest
    if: ${{ github.event.inputs.dry_run == 'false' }}
    env:
      IS_PUBLIC: ${{ github.event.inputs.is_public }}
      TAGS: ${{ github.event.inputs.tags }}
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install Playwright
        run: |
          npm init -y
          npm i playwright marked
          npx playwright install chromium

      - name: Restore final draft
        env:
          FINAL_B64: ${{ needs.factcheck.outputs.final_json_b64 }}
        run: |
          mkdir -p .note-artifacts
          echo "$FINAL_B64" | base64 -d > .note-artifacts/final.json 2>/dev/null || echo "$FINAL_B64" | base64 --decode > .note-artifacts/final.json

      - name: Prepare note storage state
        env:
          NOTE_STORAGE_STATE_JSON: ${{ secrets.NOTE_STORAGE_STATE_JSON }}
        run: |
          echo "$NOTE_STORAGE_STATE_JSON" > note-state.json

      - name: Debug storage state
        run: |
          echo "=== Checking storage state file ==="
          ls -lh note-state.json
          echo ""
          echo "First 200 chars:"
          head -c 200 note-state.json
          echo ""
          echo ""
          echo "Checking for session cookie:"
          grep -o "_note_session_v5" note-state.json && echo "‚úì Session cookie found!" || echo "‚úó Session cookie NOT found!"

„ÄÄ„ÄÄ„ÄÄ- name: Post to note.com
        run: |
          cat > post.mjs <<'EOF'
          import { chromium } from 'playwright';
          import fs from 'fs';

          const STATE_PATH = 'note-state.json';
          const IS_PUBLIC = process.env.IS_PUBLIC === 'true';

          const draft = JSON.parse(fs.readFileSync('.note-artifacts/final.json', 'utf8'));
          const title = draft.title || '„Çø„Ç§„Éà„É´';
          const body = draft.draftBody || draft.body || '';

          (async () => {
            console.log('[1] Launching browser...');
            const browser = await chromium.launch({ 
              headless: true,
              args: ['--no-sandbox', '--disable-setuid-sandbox']
            });
            
            console.log('[2] Creating context...');
            const context = await browser.newContext({ 
              storageState: STATE_PATH,
              locale: 'ja-JP',
              viewport: { width: 1920, height: 1080 }
            });
            const page = await context.newPage();

            console.log('[3] Navigating to note.com...');
            await page.goto('https://note.com/', { waitUntil: 'networkidle', timeout: 60000 });
            await page.waitForTimeout(2000);

            console.log('[4] Clicking post button...');
            const postButton = page.locator('a:has-text("ÊäïÁ®ø")').first();
            await postButton.click();
            
            await page.waitForURL(/editor\.note\.com/, { timeout: 30000 });
            console.log('  ‚úì Editor URL:', page.url());

            console.log('[5] Waiting for editor to load...');
            await page.waitForTimeout(8000);
            await page.screenshot({ path: 'step1-editor-loaded.png', fullPage: true });

            console.log('[6] Looking for "Ë®ò‰∫ã„Çø„Ç§„Éà„É´" text...');
            const titlePlaceholder = page.locator('text=Ë®ò‰∫ã„Çø„Ç§„Éà„É´');
            const titleExists = await titlePlaceholder.count();
            console.log(`  Found "${titleExists}" placeholder(s)`);

            if (titleExists > 0) {
              console.log('[7] Clicking on title area...');
              await titlePlaceholder.first().click();
              await page.waitForTimeout(500);
              console.log('  ‚úì Clicked');
            } else {
              console.log('[7] Title placeholder not found, clicking center of page...');
              await page.mouse.click(960, 300);
              await page.waitForTimeout(500);
            }

            await page.screenshot({ path: 'step2-after-click.png', fullPage: true });

            console.log('[8] Typing title...');
            await page.keyboard.type(title, { delay: 30 });
            console.log(`  ‚úì Typed: ${title.substring(0, 50)}...`);
            
            await page.screenshot({ path: 'step3-title-typed.png', fullPage: true });

            console.log('[9] Moving to body (pressing Enter)...');
            await page.keyboard.press('Enter');
            await page.waitForTimeout(800);

            console.log('[10] Typing body...');
            const bodyText = body.substring(0, 500);
            await page.keyboard.type(bodyText, { delay: 20 });
            console.log(`  ‚úì Typed ${bodyText.length} characters`);

            await page.screenshot({ path: 'step4-body-typed.png', fullPage: true });

            console.log('[11] Saving draft...');
            await page.waitForTimeout(2000);

            // ÊñπÊ≥ï1: Esc„Ç≠„Éº„Åß‰∏ãÊõ∏„Åç„É™„Çπ„Éà„Å´Êàª„ÇãÔºàËá™Âãï‰øùÂ≠ò„Åï„Çå„ÇãÔºâ
            console.log('  Trying: ESC key...');
            await page.keyboard.press('Escape');
            await page.waitForTimeout(3000);
            await page.screenshot({ path: 'step5-after-esc.png', fullPage: true });

            // URL„ÅåÂ§â„Çè„Å£„Åü„ÅãÁ¢∫Ë™ç
            const currentUrl = page.url();
            console.log('  Current URL after ESC:', currentUrl);

            if (currentUrl.includes('/notes') || currentUrl.includes('/dashboard')) {
              console.log('  ‚úì Navigated to notes list (draft saved)');
            } else {
              console.log('  ‚Ñπ Still in editor, trying other methods...');

              // ÊñπÊ≥ï2: ÂÖ®„Å¶„ÅÆ„Éú„Çø„É≥„Çí„ÉÅ„Çß„ÉÉ„ÇØ
              console.log('\n  Checking all buttons on page...');
              const allButtons = page.locator('button, a[role="button"]');
              const btnCount = await allButtons.count();
              console.log(`  Total buttons found: ${btnCount}`);

              for (let i = 0; i < Math.min(btnCount, 30); i++) {
                const text = await allButtons.nth(i).textContent();
                const ariaLabel = await allButtons.nth(i).getAttribute('aria-label');
                const cleanText = text?.trim() || '';
                
                if (cleanText.includes('‰øùÂ≠ò') || cleanText.includes('‰∏ãÊõ∏„Åç') || 
                    cleanText.includes('ÂÖ¨Èñã') || cleanText.includes('Êàª„Çã') ||
                    ariaLabel?.includes('‰øùÂ≠ò') || ariaLabel?.includes('‰∏ãÊõ∏„Åç')) {
                  console.log(`  [${i}] "${cleanText}" (aria: ${ariaLabel})`);
                  
                  // „Äå‰∏ãÊõ∏„Åç‰øùÂ≠ò„Äç„Äå‰∏ÄÊôÇ‰øùÂ≠ò„Äç„Å™„Å©„ÅÆ„Éú„Çø„É≥„Çí„ÇØ„É™„ÉÉ„ÇØ
                  if (cleanText.includes('‰∏ãÊõ∏„Åç') || cleanText.includes('‰∏ÄÊôÇ‰øùÂ≠ò')) {
                    try {
                      await allButtons.nth(i).click({ timeout: 3000 });
                      console.log(`  ‚úì Clicked: "${cleanText}"`);
                      await page.waitForTimeout(3000);
                      break;
                    } catch (e) {
                      console.log(`  ‚ö† Failed to click: ${e.message}`);
                    }
                  }
                }
              }

              // ÊñπÊ≥ï3: ÂÖ¨ÈñãË®≠ÂÆö„Å´ÈÄ≤„Çì„Åß„Åã„ÇâÊàª„Çã
              console.log('\n  Looking for "ÂÖ¨ÈñãË®≠ÂÆö" or similar button...');
              const publishButtons = [
                'text=ÂÖ¨ÈñãË®≠ÂÆö',
                'text=Ê¨°„Å∏',
                'button:has-text("ÂÖ¨Èñã")',
                'button:has-text("Ê¨°„Å∏")'
              ];

              for (const selector of publishButtons) {
                const count = await page.locator(selector).count();
                if (count > 0) {
                  console.log(`  Found: "${selector}"`);
                  try {
                    await page.locator(selector).first().click({ timeout: 3000 });
                    console.log('  ‚úì Clicked');
                    await page.waitForTimeout(2000);
                    
                    // ÂÖ¨ÈñãË®≠ÂÆöÁîªÈù¢„Å´ÁßªÂãï„Åó„Åü„Çâ„ÄÅÊàª„Çã„Éú„Çø„É≥„ÇíÊé¢„Åô
                    const backButton = page.locator('button:has-text("Êàª„Çã")');
                    const backCount = await backButton.count();
                    if (backCount > 0) {
                      await backButton.first().click();
                      console.log('  ‚úì Returned (draft saved)');
                      await page.waitForTimeout(2000);
                    }
                    break;
                  } catch (e) {
                    console.log(`  ‚ö† Failed: ${e.message}`);
                  }
                }
              }
            }

            await page.screenshot({ path: 'final-result.png', fullPage: true });
            
            const finalUrl = page.url();
            console.log('\n‚úÖ COMPLETED!');
            console.log('Final URL:', finalUrl);
            
            if (finalUrl.includes('editor.note.com')) {
              console.log('\nüìù Note: Content may auto-save. Check your drafts at:');
              console.log('   https://note.com/notes');
            } else {
              console.log('\n‚úÖ Successfully saved as draft!');
            }
            
            await browser.close();
          })().catch(err => {
            console.error('\n‚ùå ERROR:', err.message);
            console.error(err.stack);
            process.exit(1);
          });
          EOF
          node post.mjs

      - name: Upload screenshots
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: screenshots
          path: '*.png'

      - name: Upload debug files
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: debug-files
          path: |
            debug*.png
            error*.png
            final*.png
            page-debug.html

      - name: Upload screenshots
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: debug-screenshots
          path: |
            step*.png
            error*.png
            final.png
